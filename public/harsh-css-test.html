<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• Harsh CSS Test - Picasso Widget</title>
    <style>
        /* EXTREMELY AGGRESSIVE CSS THAT WOULD NORMALLY BREAK WIDGETS */
        
        /* Universal overrides with !important */
        * {
            box-sizing: content-box !important;
            margin: 50px !important;
            padding: 25px !important;
            border: 5px solid red !important;
            background: yellow !important;
            color: purple !important;
            font-family: "Comic Sans MS", cursive !important;
            font-size: 24px !important;
            line-height: 3 !important;
            text-transform: uppercase !important;
            letter-spacing: 5px !important;
        }
        
        /* Iframe targeting */
        iframe {
            transform: rotate(15deg) !important;
            filter: sepia(100%) hue-rotate(90deg) !important;
            border: 20px solid magenta !important;
            border-radius: 50px !important;
            box-shadow: 0 0 50px red !important;
            opacity: 0.5 !important;
            width: 50% !important;
            height: 200px !important;
        }
        
        /* Button destruction */
        button {
            background: linear-gradient(45deg, lime, cyan) !important;
            color: red !important;
            border: 10px dashed orange !important;
            border-radius: 50% !important;
            transform: skew(45deg) !important;
            font-size: 8px !important;
            padding: 100px !important;
            margin: 100px !important;
        }
        
        /* Input field chaos */
        input, textarea {
            background: repeating-linear-gradient(45deg, red, blue 10px) !important;
            color: white !important;
            border: 15px groove purple !important;
            font-size: 30px !important;
            transform: rotate(-10deg) scale(2) !important;
        }
        
        /* Text styling mayhem */
        p, div, span {
            writing-mode: vertical-rl !important;
            text-orientation: upright !important;
            background: linear-gradient(rainbow) !important;
            border: 3px dotted lime !important;
        }
        
        /* Animation chaos */
        @keyframes spin {
            from { transform: rotate(0deg) scale(0.5); }
            to { transform: rotate(360deg) scale(2); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(-50px); }
            50% { transform: translateY(50px); }
        }
        
        /* More destructive overrides */
        .widget-container,
        .chat-widget,
        .chat-button,
        .chat-window {
            position: static !important;
            z-index: -999 !important;
            visibility: hidden !important;
            display: none !important;
            width: 10px !important;
            height: 10px !important;
        }
        
        /* Override common widget classes */
        .picasso-widget * {
            color: lime !important;
            background: black !important;
            border: 5px solid red !important;
            font-size: 50px !important;
        }
        
        /* Reset all CSS custom properties */
        :root {
            --primary-color: red !important;
            --secondary-color: lime !important;
            --background-color: purple !important;
            --text-color: yellow !important;
            --border-radius: 0px !important;
            --font-family: "Wingdings" !important;
        }
        
        /* Host page styling that should NOT affect iframe */
        body {
            background: linear-gradient(45deg, red, blue, green, yellow, purple, orange) !important;
            font-family: "Comic Sans MS", cursive !important;
            overflow: hidden !important;
        }
        
        .test-container {
            background: rgba(255, 255, 255, 0.9) !important;
            padding: 20px !important;
            margin: 20px !important;
            border-radius: 20px !important;
            box-shadow: 0 0 30px rgba(0,0,0,0.5) !important;
            position: relative !important;
            z-index: 1000 !important;
        }
        
        .iframe-container {
            border: 5px solid #333 !important;
            border-radius: 12px !important;
            overflow: hidden !important;
            height: 600px !important;
            background: white !important;
            /* Override the universal iframe styles for our test */
            transform: none !important;
            filter: none !important;
            opacity: 1 !important;
            width: 100% !important;
            height: 600px !important;
        }
        
        .iframe-container iframe {
            /* Override harsh styles for actual widget iframe */
            transform: none !important;
            filter: none !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            opacity: 1 !important;
            width: 100% !important;
            height: 100% !important;
        }
        
        h1, h2, h3 {
            color: red !important;
            text-shadow: 3px 3px 6px black !important;
            animation: none !important;
            writing-mode: initial !important;
            transform: none !important;
        }
        
        .status {
            padding: 15px !important;
            margin: 10px 0 !important;
            border-radius: 8px !important;
            font-weight: bold !important;
            animation: none !important;
            writing-mode: initial !important;
            transform: none !important;
        }
        
        .success { 
            background: #d4edda !important; 
            color: #155724 !important; 
            border: 2px solid #c3e6cb !important; 
        }
        
        .info { 
            background: #d1ecf1 !important; 
            color: #0c5460 !important; 
            border: 2px solid #b8daff !important; 
        }
        
        ul, li {
            animation: none !important;
            writing-mode: initial !important;
            transform: none !important;
            background: transparent !important;
            border: none !important;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üî• HARSH CSS TORTURE TEST üî•</h1>
        <p style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">
            This page has <strong>EXTREMELY AGGRESSIVE CSS</strong> designed to break any widget that isn't properly isolated:
        </p>
        
        <div id="status" class="status info">
            ‚è≥ Testing CSS isolation...
        </div>
        
        <h2>üö® Aggressive CSS Applied:</h2>
        <ul style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">
            <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">Universal selectors with !important overrides</li>
            <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">Button and input styling destruction</li>
            <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">Iframe rotation, filters, and opacity changes</li>
            <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">CSS animations and transforms</li>
            <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">CSS custom property overrides</li>
            <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">Widget class targeting</li>
        </ul>
        
        <h2>üéØ Widget Should Render Perfectly:</h2>
        <div class="iframe-container">
            <iframe 
                src="/widget-frame.html?t=fo85e6a06dcdf4" 
                style="width: 100%; height: 100%; border: none;"
                title="Picasso Widget - Harsh CSS Test"
                id="widget-iframe">
            </iframe>
        </div>
        
        <div style="margin-top: 20px; writing-mode: initial !important; animation: none !important; transform: none !important; background: rgba(255,255,255,0.8) !important; border: 2px solid #333 !important; padding: 15px !important; border-radius: 8px !important;">
            <h3>‚úÖ Expected Results:</h3>
            <ul style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;">
                <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;"><strong>Widget renders normally</strong> - No visual corruption</li>
                <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;"><strong>Proper colors and styling</strong> - Widget theme intact</li>
                <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;"><strong>Functional interactions</strong> - Buttons and inputs work</li>
                <li style="writing-mode: initial !important; animation: none !important; transform: none !important; background: transparent !important; border: none !important;"><strong>No CSS inheritance</strong> - Host page styles don't leak in</li>
            </ul>
        </div>
    </div>

    <script>
        const statusEl = document.getElementById('status');
        
        function updateStatus(message, type = 'info') {
            statusEl.className = `status ${type}`;
            statusEl.textContent = message;
        }
        
        // Listen for iframe messages
        window.addEventListener('message', (event) => {
            console.log('üî• Harsh CSS test received message:', event.data);
            
            if (event.data.type === 'PICASSO_IFRAME_READY') {
                updateStatus('üõ°Ô∏è Widget loaded successfully despite harsh CSS!', 'success');
            }
        });
        
        // Timeout check
        setTimeout(() => {
            if (statusEl.textContent.includes('Testing')) {
                updateStatus('‚ö†Ô∏è Widget may have issues with CSS isolation', 'warning');
            }
        }, 10000);
        
        // Static harsh background - no dynamic changes to avoid Vite reloads
        console.log('üî• Harsh CSS test page loaded - static version for stability');
    </script>
</body>
</html> 