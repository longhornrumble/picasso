<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="theme-color" content="#1D4ED8" />
  
  <!-- SEO and Social Meta Tags -->
  <title>Picasso AI Chat Widget</title>
  <meta name="description" content="AI-powered chat widget for customer engagement and support automation. Seamless integration for nonprofits and businesses." />
  <meta name="keywords" content="AI chat, customer support, chatbot, widget, nonprofit, automation" />
  <meta name="author" content="MyRecruiter" />
  <meta name="robots" content="noindex, nofollow" />
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Picasso AI Chat Widget" />
  <meta property="og:description" content="AI-powered chat widget for customer engagement" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="MyRecruiter Picasso" />
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Picasso AI Chat Widget" />
  <meta name="twitter:description" content="AI-powered chat widget for customer engagement" />
  
  <!-- Enhanced Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
  <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), payment=()" />

  <!-- Enhanced Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com 'nonce-${nonce}';
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: https: blob:;
    connect-src 'self' https://api.myrecruiter.ai https://chat.myrecruiter.ai https://staging-chat.myrecruiter.ai wss:;
    frame-src 'self';
    object-src 'none';
    base-uri 'self';
    form-action 'self';
    upgrade-insecure-requests;
    block-all-mixed-content;
    require-trusted-types-for 'script';
  " />
  
  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  
  <!-- Web App Manifest -->
  <link rel="manifest" href="/manifest.json" />
  
  <!-- Preconnect to External Domains -->
  <link rel="preconnect" href="https://api.myrecruiter.ai" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  
  <!-- Font Loading Optimization -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'" />
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" /></noscript>
  
  <!-- Critical CSS Inlining (Production optimization) -->
  <style>
    /* Critical above-the-fold CSS */
    *,*::before,*::after{box-sizing:border-box;}
    body{margin:0;font-family:Inter,system-ui,-apple-system,sans-serif;background:#ffffff;}
    #root{min-height:100vh;}
    .loading{display:flex;align-items:center;justify-content:center;min-height:100vh;color:#6b7280;}
    
    /* Loading spinner */
    .spinner{width:32px;height:32px;border:3px solid #f3f4f6;border-radius:50%;border-top-color:#1d4ed8;animation:spin 1s ease-in-out infinite;}
    @keyframes spin{to{transform:rotate(360deg);}}
  </style>
  
  <!-- Environment Configuration with Security -->
  <script nonce="picasso-config">
    // Set global environment configuration with security validation
    window.PICASSO_ENV = 'production';
    window.PICASSO_VERSION = '2.0.0';
    window.PICASSO_BUILD_TIME = '2025-06-20T15:30:00Z';
    
    // Security: Validate environment configuration
    (function() {
      'use strict';
      
      // Performance monitoring
      window.PICASSO_PERFORMANCE = {
        startTime: performance.now(),
        navigationStart: performance.timing ? performance.timing.navigationStart : Date.now()
      };
      
      // Security: Error tracking with sanitization
      window.addEventListener('error', function(event) {
        // Sanitize error information before logging
        const sanitizedError = {
          message: event.message ? event.message.substring(0, 200) : 'Unknown error',
          filename: event.filename ? event.filename.split('/').pop() : 'unknown',
          lineno: event.lineno || 0,
          colno: event.colno || 0,
          timestamp: Date.now()
        };
        
        console.error('Global error:', sanitizedError);
        // In production, send to error tracking service with sanitized data
      });
      
      window.addEventListener('unhandledrejection', function(event) {
        // Sanitize rejection information
        const sanitizedRejection = {
          reason: event.reason ? String(event.reason).substring(0, 200) : 'Unknown rejection',
          timestamp: Date.now()
        };
        
        console.error('Unhandled promise rejection:', sanitizedRejection);
        // In production, send to error tracking service with sanitized data
      });
      
      // Security: Prevent prototype pollution
      Object.freeze(window.PICASSO_ENV);
      Object.freeze(window.PICASSO_VERSION);
      Object.freeze(window.PICASSO_BUILD_TIME);
      Object.freeze(window.PICASSO_PERFORMANCE);
    })();
  </script>
</head>
<body>
  <!-- Fallback for users with JavaScript disabled -->
  <noscript>
    <div style="padding: 40px; text-align: center; font-family: Inter, sans-serif;">
      <h2 style="color: #1f2937; margin-bottom: 16px;">JavaScript Required</h2>
      <p style="color: #6b7280; line-height: 1.5;">
        This chat widget requires JavaScript to function properly. 
        Please enable JavaScript in your browser and refresh the page.
      </p>
    </div>
  </noscript>
  <div id="root"></div>
  <script type="module" src="/main.js" nonce="picasso-main"></script>
</body>
</html>
