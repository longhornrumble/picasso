{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://chat.myrecruiter.ai/schemas/monitoring.schema.json",
  "title": "Monitoring Configuration Schema",
  "description": "Schema for monitoring, observability, and performance tracking configuration",
  "type": "object",
  "properties": {
    "metrics": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable metrics collection"
        },
        "collectors": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Collector name"
              },
              "type": {
                "type": "string",
                "enum": ["prometheus", "datadog", "newrelic", "custom"],
                "description": "Metrics collector type"
              },
              "endpoint": {
                "type": "string",
                "format": "uri",
                "description": "Metrics endpoint URL"
              },
              "apiKey": {
                "type": "string",
                "description": "API key for metrics service"
              },
              "interval": {
                "type": "number",
                "minimum": 1000,
                "maximum": 300000,
                "description": "Collection interval in milliseconds"
              },
              "batchSize": {
                "type": "number",
                "minimum": 1,
                "maximum": 1000,
                "description": "Batch size for metric submissions"
              }
            },
            "required": ["name", "type", "endpoint", "interval"],
            "additionalProperties": false
          },
          "description": "Metrics collectors configuration"
        },
        "categories": {
          "type": "object",
          "properties": {
            "performance": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean"
                },
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "response_time",
                      "throughput",
                      "error_rate",
                      "memory_usage",
                      "cpu_usage",
                      "network_latency",
                      "bundle_size",
                      "render_time",
                      "first_contentful_paint",
                      "largest_contentful_paint",
                      "cumulative_layout_shift"
                    ]
                  }
                }
              },
              "required": ["enabled", "metrics"],
              "additionalProperties": false
            },
            "business": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean"
                },
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "chat_sessions",
                      "message_count",
                      "user_engagement",
                      "conversion_rate",
                      "session_duration",
                      "bounce_rate",
                      "feature_usage",
                      "tenant_activity"
                    ]
                  }
                }
              },
              "required": ["enabled", "metrics"],
              "additionalProperties": false
            },
            "security": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean"
                },
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "failed_authentications",
                      "blocked_requests",
                      "csp_violations",
                      "suspicious_activity",
                      "rate_limit_hits"
                    ]
                  }
                }
              },
              "required": ["enabled", "metrics"],
              "additionalProperties": false
            }
          },
          "required": ["performance", "business", "security"],
          "additionalProperties": false
        },
        "sampling": {
          "type": "object",
          "properties": {
            "rate": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Sampling rate (0-1)"
            },
            "strategy": {
              "type": "string",
              "enum": ["random", "systematic", "adaptive"],
              "description": "Sampling strategy"
            }
          },
          "required": ["rate", "strategy"],
          "additionalProperties": false
        }
      },
      "required": ["enabled", "collectors", "categories", "sampling"],
      "additionalProperties": false
    },
    "logging": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable logging"
        },
        "level": {
          "type": "string",
          "enum": ["debug", "info", "warn", "error", "fatal"],
          "description": "Minimum log level"
        },
        "outputs": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Output name"
              },
              "type": {
                "type": "string",
                "enum": ["console", "file", "remote", "elasticsearch", "cloudwatch"],
                "description": "Log output type"
              },
              "config": {
                "type": "object",
                "properties": {
                  "endpoint": {
                    "type": "string",
                    "format": "uri",
                    "description": "Remote logging endpoint"
                  },
                  "apiKey": {
                    "type": "string",
                    "description": "API key for logging service"
                  },
                  "index": {
                    "type": "string",
                    "description": "Index name for structured logs"
                  },
                  "retention": {
                    "type": "number",
                    "minimum": 1,
                    "maximum": 365,
                    "description": "Log retention in days"
                  }
                },
                "additionalProperties": false
              }
            },
            "required": ["name", "type"],
            "additionalProperties": false
          },
          "description": "Log output configurations"
        },
        "format": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["json", "text", "structured"],
              "description": "Log format type"
            },
            "timestamp": {
              "type": "boolean",
              "description": "Include timestamp in logs"
            },
            "level": {
              "type": "boolean",
              "description": "Include log level in logs"
            },
            "source": {
              "type": "boolean",
              "description": "Include source location in logs"
            },
            "requestId": {
              "type": "boolean",
              "description": "Include request ID for tracing"
            }
          },
          "required": ["type"],
          "additionalProperties": false
        },
        "sanitization": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable log sanitization"
            },
            "fields": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Fields to sanitize in logs"
            },
            "patterns": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Regex patterns to sanitize"
            }
          },
          "required": ["enabled"],
          "additionalProperties": false
        }
      },
      "required": ["enabled", "level", "outputs", "format", "sanitization"],
      "additionalProperties": false
    },
    "tracing": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable distributed tracing"
        },
        "service": {
          "type": "string",
          "enum": ["jaeger", "zipkin", "datadog", "newrelic", "custom"],
          "description": "Tracing service"
        },
        "endpoint": {
          "type": "string",
          "format": "uri",
          "description": "Tracing collector endpoint"
        },
        "samplingRate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Trace sampling rate (0-1)"
        },
        "operations": {
          "type": "object",
          "properties": {
            "http": {
              "type": "boolean",
              "description": "Trace HTTP requests"
            },
            "database": {
              "type": "boolean",
              "description": "Trace database operations"
            },
            "cache": {
              "type": "boolean",
              "description": "Trace cache operations"
            },
            "external": {
              "type": "boolean",
              "description": "Trace external service calls"
            }
          },
          "additionalProperties": false
        },
        "headers": {
          "type": "object",
          "properties": {
            "traceId": {
              "type": "string",
              "description": "Trace ID header name"
            },
            "spanId": {
              "type": "string",
              "description": "Span ID header name"
            },
            "baggage": {
              "type": "string",
              "description": "Baggage header name"
            }
          },
          "additionalProperties": false
        }
      },
      "required": ["enabled"],
      "additionalProperties": false
    },
    "alerts": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable alerting"
        },
        "channels": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Alert channel name"
              },
              "type": {
                "type": "string",
                "enum": ["email", "slack", "webhook", "pagerduty", "custom"],
                "description": "Alert channel type"
              },
              "config": {
                "type": "object",
                "properties": {
                  "endpoint": {
                    "type": "string",
                    "format": "uri",
                    "description": "Alert endpoint URL"
                  },
                  "apiKey": {
                    "type": "string",
                    "description": "API key for alert service"
                  },
                  "recipients": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Alert recipients"
                  }
                },
                "additionalProperties": false
              }
            },
            "required": ["name", "type"],
            "additionalProperties": false
          },
          "description": "Alert channel configurations"
        },
        "rules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Alert rule name"
              },
              "metric": {
                "type": "string",
                "description": "Metric to monitor"
              },
              "condition": {
                "type": "string",
                "enum": ["greater_than", "less_than", "equals", "not_equals"],
                "description": "Alert condition"
              },
              "threshold": {
                "type": "number",
                "description": "Alert threshold value"
              },
              "duration": {
                "type": "number",
                "minimum": 60,
                "maximum": 86400,
                "description": "Duration in seconds before alerting"
              },
              "severity": {
                "type": "string",
                "enum": ["low", "medium", "high", "critical"],
                "description": "Alert severity"
              },
              "channels": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Alert channels to notify"
              }
            },
            "required": ["name", "metric", "condition", "threshold", "severity", "channels"],
            "additionalProperties": false
          },
          "description": "Alert rules configuration"
        }
      },
      "required": ["enabled", "channels", "rules"],
      "additionalProperties": false
    },
    "healthChecks": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable health checks"
        },
        "interval": {
          "type": "number",
          "minimum": 5000,
          "maximum": 300000,
          "description": "Health check interval in milliseconds"
        },
        "timeout": {
          "type": "number",
          "minimum": 1000,
          "maximum": 30000,
          "description": "Health check timeout in milliseconds"
        },
        "checks": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Health check name"
              },
              "type": {
                "type": "string",
                "enum": ["http", "tcp", "custom"],
                "description": "Health check type"
              },
              "endpoint": {
                "type": "string",
                "format": "uri",
                "description": "Health check endpoint"
              },
              "expectedStatus": {
                "type": "number",
                "minimum": 200,
                "maximum": 299,
                "description": "Expected HTTP status code"
              },
              "critical": {
                "type": "boolean",
                "description": "Mark as critical check"
              }
            },
            "required": ["name", "type"],
            "additionalProperties": false
          },
          "description": "Health check configurations"
        }
      },
      "required": ["enabled", "interval", "timeout", "checks"],
      "additionalProperties": false
    },
    "performance": {
      "type": "object",
      "properties": {
        "webVitals": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable Core Web Vitals monitoring"
            },
            "thresholds": {
              "type": "object",
              "properties": {
                "lcp": {
                  "type": "number",
                  "minimum": 100,
                  "maximum": 10000,
                  "description": "Largest Contentful Paint threshold (ms)"
                },
                "fid": {
                  "type": "number",
                  "minimum": 10,
                  "maximum": 1000,
                  "description": "First Input Delay threshold (ms)"
                },
                "cls": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "description": "Cumulative Layout Shift threshold"
                }
              },
              "required": ["lcp", "fid", "cls"],
              "additionalProperties": false
            }
          },
          "required": ["enabled", "thresholds"],
          "additionalProperties": false
        },
        "resourceTiming": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable resource timing monitoring"
            },
            "bufferSize": {
              "type": "number",
              "minimum": 50,
              "maximum": 1000,
              "description": "Resource timing buffer size"
            }
          },
          "required": ["enabled"],
          "additionalProperties": false
        },
        "userTiming": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable user timing API monitoring"
            },
            "marks": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Performance marks to monitor"
            },
            "measures": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Performance measures to monitor"
            }
          },
          "required": ["enabled"],
          "additionalProperties": false
        }
      },
      "required": ["webVitals", "resourceTiming", "userTiming"],
      "additionalProperties": false
    }
  },
  "required": ["metrics", "logging", "tracing", "alerts", "healthChecks", "performance"],
  "additionalProperties": false
}